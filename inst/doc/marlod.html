<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>User Guide for the R Package: marlod</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">User Guide for the R Package:
<em>marlod</em></h1>



<div id="introduction" class="section level2">
<h2>1. Introduction</h2>
<p>This vignette provides instructions on how to perform marginal
modeling for exposure data with repeated measures and non-detects.
Environmental exposure and biomonitoring data from environmental and
occupational studies often exhibit right-skewed distributions and
left-censored. Left censoring occurs when laboratory instruments have a
limit of detection (LOD) below which measurements are not provided.</p>
<p>To conduct regression models for repeated measures data with
non-detects, it is necessary to install the R package:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(marlod)</span></code></pre></div>
<p>After building and installing the package, you can view the vignette
by using the command:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">browseVignettes</span>(<span class="at">package =</span> <span class="st">&#39;marlod&#39;</span>)</span></code></pre></div>
</div>
<div id="substitution-methods" class="section level2">
<h2>2. Substitution Methods</h2>
<p>To impute values that are below the LOD, the function
<code>Fillin()</code> can be used. This section demonstrates the
function using an example from Ganser and Hewett (2010). The available
substitution methods for this function include: “None”, “LOD”, “LOD2”,
“LODS2”, and “QQplot”. A detailed description of each substitution
method can be found in the Reference Manual of the Documentation.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">3.06</span>,<span class="fl">4.41</span>,<span class="fl">7.23</span>,<span class="fl">8.29</span>,<span class="fl">9.52</span>,<span class="fl">19.94</span>,<span class="fl">20.25</span>) </span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="do">## Limit of detection (LOD) = 3</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>lod <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="fu">Fillin</span>(y, lod, <span class="st">&quot;BetaMean&quot;</span>)</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt;  [1]  1.762431  1.762431  1.762431  3.060000  4.410000  7.230000  8.290000</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt;  [8]  9.520000 19.940000 20.250000</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="fu">Fillin</span>(y, lod, <span class="st">&quot;BetaGM&quot;</span>)</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt;  [1]  1.482424  1.482424  1.482424  3.060000  4.410000  7.230000  8.290000</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt;  [8]  9.520000 19.940000 20.250000</span></span></code></pre></div>
</div>
<div id="outcome-data-normal-or-log-normal-distribution" class="section level2">
<h2>3. Outcome Data: Normal or Log-Normal Distribution</h2>
<p>Conventional statistical analyses often assume that responses or
outcome data follow a normal distribution. If the underlying
distribution is log-normal, data transformation using the natural
logarithm required. To analyze such data, marginal models utilizing
estimation methods such as generalized estimating equations (GEE),
quadratic inference functions (QIF), and generalized method of moments
(GMM) are employed. These methods incorporate the imputation of
measurements below the LOD using single and multiple value imputation
techniques (Chen <em>et al</em>., 2024).</p>
<div id="simulated-dataset-15" class="section level3">
<h3>3-1. Simulated Dataset 15</h3>
<p>The 15th dataset from a simulation study includes 100 subjects
(sample size is 100), each with three repeated measurements. The
independent variables or covariates (x1 and x2) are simulated from a
binomial distribution with a parameter value of <span class="math inline">\(p = 0.5\)</span> and a uniform distribution <span class="math inline">\(U(0, 1)\)</span>, respectively. Correlated errors
for repeated measures models are accounted for and assumed to follow a
multivariate normal distribution, <span class="math inline">\(MVN(0,
R(\alpha))\)</span>. A first-order autoregressive (AR-1) correlation
structure with a correlation parameter of <span class="math inline">\(\alpha = 0.7\)</span> is incorporated. The true
values of 1, 1, and 1 correspond to the marginal intercept and two
slopes.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">data</span>(simdata15)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">head</span>(simdata15)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt;           y int x1        x2 id visit</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt; 1  3.879122   1  1 0.7528836  1     1</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; 2  4.008937   1  1 0.7528836  1     2</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; 3  4.380099   1  1 0.7528836  1     3</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt; 4  1.847881   1  0 0.8511011  2     1</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; 5  1.806600   1  0 0.8511011  2     2</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt; 6 -0.146508   1  0 0.8511011  2     3</span></span></code></pre></div>
</div>
<div id="marginal-modeling-mean-regression-model" class="section level3">
<h3>3-2. Marginal Modeling (Mean Regression Model)</h3>
<p>To conduct regression analysis using the 15th simulated dataset,
assume the LOD is 2; thus, any measurements below 2 would be imputed
using substitution approaches, such as “QQplot”. For repeated measures
in a cluster study, an “exchangeable” correlation structure is used,
while “AR-1” is appropriate for longitudinal datasets where subjects are
measured over time. The example below employs the function
<code>Modified.GEE()</code> for the GEE method. The atomic vector
“typed” specifies the types of time-dependent covaraites, with the
length of the vector equal to the number of regression parameters,
excluding the intercept. For time-independent covariates or those in a
cluster study, “1” is assigned, thus “c(1,1)” is used for “typed”. The
maximum number of iterations is set to 1,000.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>id<span class="ot">=</span><span class="fu">as.matrix</span>(<span class="fu">as.vector</span>(<span class="fu">t</span>(simdata15<span class="sc">$</span>id)))</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>y<span class="ot">=</span><span class="fu">as.matrix</span>(<span class="fu">as.vector</span>(<span class="fu">t</span>(simdata15<span class="sc">$</span>y)))</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>x1<span class="ot">=</span><span class="fu">as.matrix</span>(<span class="fu">as.vector</span>(<span class="fu">t</span>(simdata15<span class="sc">$</span>x1)))</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>x2<span class="ot">=</span><span class="fu">as.matrix</span>(<span class="fu">as.vector</span>(<span class="fu">t</span>(simdata15<span class="sc">$</span>x2)))</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">cbind</span>(x1,x2)</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="do">## LOD = 2 is equivalent to detection proportion = 56.3% (censoring proportion = 43.7%).</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>lod<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="do">## Intercept is not included in the &quot;x&quot; and &quot;typed&quot;.</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="do">## Modified.GEE(id, y, x, lod, substitue, corstr, typetd, maxiter)</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="fu">Modified.GEE</span>(id, y, x, lod, <span class="st">&quot;QQplot&quot;</span>, <span class="st">&quot;AR-1&quot;</span>, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="dv">1000</span>)</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#&gt; Results include typical asymptotic standard error (SE) estimates and bias-corrected SE estimates that use covariance inflation corrections.</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co">#&gt; Covariance inflation corrections are based on the corrections of Mancl and DeRouen (MD) (2001), and Kauermann and Carroll (KC) (2001).</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co">#&gt; Last covariance inflation correction averages the above corrections (AVG) (Ford and Westgate, 2017, 2018).</span></span></code></pre></div>
<table>
<colgroup>
<col width="17%" />
<col width="13%" />
<col width="13%" />
<col width="12%" />
<col width="15%" />
<col width="14%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Parameter</th>
<th align="left">Estimate</th>
<th align="left">Standard Error</th>
<th align="left">Wald Statistic</th>
<th align="left">p-value</th>
<th align="left">TECM</th>
<th align="left">CIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Typical Asymptotic SE</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">0</td>
<td align="left">1.41889291637309</td>
<td align="left">0.117296637893661</td>
<td align="left">12.0966205157511</td>
<td align="left">0</td>
<td align="left">0.0826889924640298</td>
<td align="left">6.63582649603307</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left">0.70842894519093</td>
<td align="left">0.120271120631658</td>
<td align="left">5.89026643694925</td>
<td align="left">5.55713504102329e-08</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">1.14012150968324</td>
<td align="left">0.233378123963833</td>
<td align="left">4.88529726059467</td>
<td align="left">4.07412042346955e-06</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">Bias-Corrected SE (MD)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">0</td>
<td align="left">1.41889291637309</td>
<td align="left">0.121569957897582</td>
<td align="left">11.671410773774</td>
<td align="left">0</td>
<td align="left">0.0891285922808028</td>
<td align="left">7.1239067842054</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left">0.70842894519093</td>
<td align="left">0.124580417761904</td>
<td align="left">5.68651926135669</td>
<td align="left">1.36804927164391e-07</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">1.14012150968324</td>
<td align="left">0.242547020447278</td>
<td align="left">4.70062055423626</td>
<td align="left">8.57351781924365e-06</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">Bias-Corrected SE (KC)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">0</td>
<td align="left">1.41889291637309</td>
<td align="left">0.119412406036419</td>
<td align="left">11.8822906552972</td>
<td align="left">0</td>
<td align="left">0.0858454535090291</td>
<td align="left">6.87523734400911</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left">0.70842894519093</td>
<td align="left">0.122403870291727</td>
<td align="left">5.78763517446403</td>
<td align="left">8.76355334966661e-08</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">1.14012150968324</td>
<td align="left">0.237914739625835</td>
<td align="left">4.79214323364871</td>
<td align="left">5.94118008701017e-06</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">Bias-Corrected SE (AVG)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">0</td>
<td align="left">1.41889291637309</td>
<td align="left">0.120496011092954</td>
<td align="left">11.7754347509356</td>
<td align="left">0</td>
<td align="left">0.0858454535090291</td>
<td align="left">6.99957206410726</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left">0.70842894519093</td>
<td align="left">0.12349693913641</td>
<td align="left">5.73640893567755</td>
<td align="left">1.0986445742045e-07</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">1.14012150968324</td>
<td align="left">0.240242045091072</td>
<td align="left">4.74572013092478</td>
<td align="left">7.15943746354419e-06</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">Estimated correlation</td>
<td align="left">0.664821305215864</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">Estimated dispersion</td>
<td align="left">0.511033918398329</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
</tbody>
</table>
<p>The QIF method is performed using the function
<code>Modified.GEE()</code>, which typically demonstrates efficiency
advantages over GEE in large sample sizes.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="do">## Gets initial estimates for the QIF approach through independence structure</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>initial<span class="ot">=</span><span class="fu">glm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data=</span>simdata15, <span class="at">family=</span>gaussian)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>beta_initial<span class="ot">=</span><span class="fu">as.matrix</span>(initial<span class="sc">$</span>coefficients)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="do">## Intercept is not included in the &quot;x&quot; and &quot;typed&quot;.</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="do">## Modified.QIF(id, y, x, lod, substitue, corstr, beta, typetd, maxiter)</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="fu">Modified.QIF</span>(id, y, x, lod, <span class="st">&quot;QQplot&quot;</span>, <span class="st">&quot;exchangeable&quot;</span>, beta_initial, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="dv">1000</span>)</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">#&gt; Results include typical asymptotic standard error (SE) estimates and bias-corrected SE estimates that use covariance inflation corrections.</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#&gt; Covariance inflation corrections are based on the corrections of Mancl and DeRouen (MD) (2001), and Kauermann and Carroll (KC) (2001).</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co">#&gt; Last covariance inflation correction averages the above corrections (AVG) (Ford and Westgate, 2017, 2018).</span></span></code></pre></div>
<table>
<colgroup>
<col width="8%" />
<col width="16%" />
<col width="11%" />
<col width="12%" />
<col width="11%" />
<col width="14%" />
<col width="13%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">Parameter</th>
<th align="left">Estimate</th>
<th align="left">Standard Error</th>
<th align="left">Wald Statistic</th>
<th align="left">p-value</th>
<th align="left">TECM</th>
<th align="left">CIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"></td>
<td align="left">Typical Asymptotic SE</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">(Intercept)</td>
<td align="left">0</td>
<td align="left">1.43745433084147</td>
<td align="left">0.163267610463611</td>
<td align="left">8.80428351195755</td>
<td align="left">5.10702591327572e-14</td>
<td align="left">0.12389623547046</td>
<td align="left">7.60882967081079</td>
</tr>
<tr class="odd">
<td align="left">x1</td>
<td align="left">1</td>
<td align="left">0.71367264050939</td>
<td align="left">0.148937691261059</td>
<td align="left">4.79175307785898</td>
<td align="left">5.95052545859787e-06</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">x2</td>
<td align="left">2</td>
<td align="left">1.12391823394195</td>
<td align="left">0.27396621500796</td>
<td align="left">4.10239720218529</td>
<td align="left">8.51430721415802e-05</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Bias-Corrected SE (MD)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">(Intercept)</td>
<td align="left">0</td>
<td align="left">1.43745433084147</td>
<td align="left">0.123035028606317</td>
<td align="left">11.6832933443775</td>
<td align="left">0</td>
<td align="left">0.0911928228535921</td>
<td align="left">5.86921377221324</td>
</tr>
<tr class="odd">
<td align="left">x1</td>
<td align="left">1</td>
<td align="left">0.71367264050939</td>
<td align="left">0.126351479859632</td>
<td align="left">5.6483124796182</td>
<td align="left">1.61730083991785e-07</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">x2</td>
<td align="left">2</td>
<td align="left">1.12391823394195</td>
<td align="left">0.245133653598839</td>
<td align="left">4.5849201749395</td>
<td align="left">1.3554024130169e-05</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Bias-Corrected SE (KC)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">(Intercept)</td>
<td align="left">0</td>
<td align="left">1.43745433084147</td>
<td align="left">0.12084505122269</td>
<td align="left">11.895020245327</td>
<td align="left">0</td>
<td align="left">0.0878152589014619</td>
<td align="left">5.66351137004654</td>
</tr>
<tr class="odd">
<td align="left">x1</td>
<td align="left">1</td>
<td align="left">0.71367264050939</td>
<td align="left">0.124140764428436</td>
<td align="left">5.74889838801342</td>
<td align="left">1.0398148631019e-07</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">x2</td>
<td align="left">2</td>
<td align="left">1.12391823394195</td>
<td align="left">0.240417975832862</td>
<td align="left">4.67485107986806</td>
<td align="left">9.49951150097661e-06</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Bias-Corrected SE (AVG)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">(Intercept)</td>
<td align="left">0</td>
<td align="left">1.43745433084147</td>
<td align="left">0.121944956167059</td>
<td align="left">11.7877309240427</td>
<td align="left">0</td>
<td align="left">0.0878152589014619</td>
<td align="left">5.76636257112989</td>
</tr>
<tr class="odd">
<td align="left">x1</td>
<td align="left">1</td>
<td align="left">0.71367264050939</td>
<td align="left">0.125250999707778</td>
<td align="left">5.69793967452918</td>
<td align="left">1.30116281304993e-07</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">x2</td>
<td align="left">2</td>
<td align="left">1.12391823394195</td>
<td align="left">0.242787264112316</td>
<td align="left">4.6292306066846</td>
<td align="left">1.13820322262814e-05</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
</tbody>
</table>
<p>Another estimation method, GMM, is employed using the function
<code>Modified.GMM()</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="do">## Gets initial estimates for the GMM approach through independence structure</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>initial<span class="ot">=</span><span class="fu">glm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data=</span>simdata15, <span class="at">family=</span>gaussian)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>beta_initial<span class="ot">=</span><span class="fu">as.matrix</span>(initial<span class="sc">$</span>coefficients)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="do">## Intercept is not included in the &quot;x&quot; and &quot;typed&quot;.</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="do">## Modified.GMM(id, y, x, lod, substitue, beta, maxiter)</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="fu">Modified.GMM</span>(id, y, x, lod, <span class="st">&quot;QQplot&quot;</span>, beta_initial, <span class="dv">1000</span>)</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt; Results include typical asymptotic standard error (SE) estimates and bias-corrected SE estimates that use covariance inflation corrections.</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt; Covariance inflation corrections are based on the corrections of Mancl and DeRouen (MD) (2001), and Kauermann and Carroll (KC) (2001).</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt; Last covariance inflation correction averages the above corrections (AVG) (Ford and Westgate, 2017, 2018).</span></span></code></pre></div>
<table>
<colgroup>
<col width="8%" />
<col width="16%" />
<col width="12%" />
<col width="12%" />
<col width="11%" />
<col width="14%" />
<col width="13%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">Parameter</th>
<th align="left">Estimate</th>
<th align="left">Standard Error</th>
<th align="left">Wald Statistic</th>
<th align="left">p-value</th>
<th align="left">TECM</th>
<th align="left">CIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"></td>
<td align="left">Typical Asymptotic SE</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">(Intercept)</td>
<td align="left">0</td>
<td align="left">1.43745433084149</td>
<td align="left">0.11869769948294</td>
<td align="left">12.1102122206513</td>
<td align="left">0</td>
<td align="left">0.0845688751173853</td>
<td align="left">5.46551267185539</td>
</tr>
<tr class="odd">
<td align="left">x1</td>
<td align="left">1</td>
<td align="left">0.713672640509396</td>
<td align="left">0.12197480319244</td>
<td align="left">5.85098415271417</td>
<td align="left">6.6182999303166e-08</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">x2</td>
<td align="left">2</td>
<td align="left">1.12391823394191</td>
<td align="left">0.235800506023648</td>
<td align="left">4.76639449547743</td>
<td align="left">6.5895608287736e-06</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Bias-Corrected SE (MD)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">(Intercept)</td>
<td align="left">0</td>
<td align="left">1.43745433084149</td>
<td align="left">0.123035028606323</td>
<td align="left">11.683293344377</td>
<td align="left">0</td>
<td align="left">0.0911928228536039</td>
<td align="left">5.86921377221358</td>
</tr>
<tr class="odd">
<td align="left">x1</td>
<td align="left">1</td>
<td align="left">0.713672640509396</td>
<td align="left">0.126351479859629</td>
<td align="left">5.64831247961839</td>
<td align="left">1.61730083991785e-07</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">x2</td>
<td align="left">2</td>
<td align="left">1.12391823394191</td>
<td align="left">0.245133653598862</td>
<td align="left">4.58492017493892</td>
<td align="left">1.3554024130169e-05</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Bias-Corrected SE (KC)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">(Intercept)</td>
<td align="left">0</td>
<td align="left">1.43745433084149</td>
<td align="left">0.120845051222696</td>
<td align="left">11.8950202453265</td>
<td align="left">0</td>
<td align="left">0.0878152589014733</td>
<td align="left">5.66351137004685</td>
</tr>
<tr class="odd">
<td align="left">x1</td>
<td align="left">1</td>
<td align="left">0.713672640509396</td>
<td align="left">0.124140764428433</td>
<td align="left">5.74889838801362</td>
<td align="left">1.0398148631019e-07</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">x2</td>
<td align="left">2</td>
<td align="left">1.12391823394191</td>
<td align="left">0.240417975832885</td>
<td align="left">4.67485107986746</td>
<td align="left">9.49951150097661e-06</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Bias-Corrected SE (AVG)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">(Intercept)</td>
<td align="left">0</td>
<td align="left">1.43745433084149</td>
<td align="left">0.121944956167065</td>
<td align="left">11.7877309240423</td>
<td align="left">0</td>
<td align="left">0.0878152589014733</td>
<td align="left">5.76636257113022</td>
</tr>
<tr class="odd">
<td align="left">x1</td>
<td align="left">1</td>
<td align="left">0.713672640509396</td>
<td align="left">0.125250999707775</td>
<td align="left">5.69793967452937</td>
<td align="left">1.30116281304993e-07</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">x2</td>
<td align="left">2</td>
<td align="left">1.12391823394191</td>
<td align="left">0.242787264112338</td>
<td align="left">4.62923060668401</td>
<td align="left">1.13820322262814e-05</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
</tbody>
</table>
</div>
<div id="time-dependent-covariates" class="section level3">
<h3>3-3. Time-Dependent Covariates</h3>
<p>To handle time-dependent covariates, we use the 58th dataset from a
simulation study, which includes 100 subjects (sample size is 100), each
with three measurements collected over time. Detailed model mechanism
are described in the setting II for type III time-dependent covariate on
page 90 of Lai and Small (2007).</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">data</span>(simdata58)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="fu">head</span>(simdata58)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co">#&gt;             y int         x1 id visit</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt; 1  2.13315183   1 -0.1061468  1     1</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt; 2 -0.93398126   1 -0.1406264  1     2</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt; 3  0.38660420   1 -0.2905621  1     3</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt; 4  0.70977961   1  0.1533462  2     1</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt; 5 -0.07722418   1  0.3018084  2     2</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt; 6  0.71894327   1 -0.1685652  2     3</span></span></code></pre></div>
<p>Failure to account for time-dependency in covariates can lead to
inefficient regression parameter estimation. The function
<code>Selected.GEE()</code> allows the selection of a type of
time-dependent covariate through a marginal mean regression model using
the GEE estimation method for longitudinal data with values below the
LOD. The selection approach applied to choose a type of time-dependency
is the empirical mean squared error (MSE) minimization criterion (Chen
and Westgate, 2017, 2019). Given the longitudinal nature of the dataset,
“AR-1” is used as the working correlation structure.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>id<span class="ot">=</span><span class="fu">as.matrix</span>(<span class="fu">as.vector</span>(<span class="fu">t</span>(simdata58<span class="sc">$</span>id)))</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>y<span class="ot">=</span><span class="fu">as.matrix</span>(<span class="fu">as.vector</span>(<span class="fu">t</span>(simdata58<span class="sc">$</span>y)))</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>x1<span class="ot">=</span><span class="fu">as.matrix</span>(<span class="fu">as.vector</span>(<span class="fu">t</span>(simdata58<span class="sc">$</span>x1)))</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="do">## LOD = 0.05 is equivalent to detection proportion = 50.7% (censoring proportion = 49.3%).</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>lod<span class="ot">=</span><span class="fl">0.05</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="do">## Intercept is not included in the &quot;x&quot;.</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="do">## Selected.GEE(id, y, x, lod, substitue, corstr, maxiter)</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="fu">Selected.GEE</span>(id, y, x1, lod, <span class="st">&quot;MIWithID&quot;</span>, <span class="st">&quot;AR-1&quot;</span>, <span class="dv">1000</span>)</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#&gt; Selected type of time-dependent covariate</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co">#&gt; 3</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co">#&gt; Results based on the empirical MSE minimization criterion (EMMC)</span></span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Type</th>
<th align="right">EMMC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0.0015313</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">0.0014112</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">0.0011461</td>
</tr>
</tbody>
</table>
<p>Once the type of time-dependent covaraite is selected, i.e., in this
case, <strong>type 3</strong>, it can be updated in the “typed” vector
of the function <code>Modified.GEE()</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>id<span class="ot">=</span><span class="fu">as.matrix</span>(<span class="fu">as.vector</span>(<span class="fu">t</span>(simdata58<span class="sc">$</span>id)))</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>y<span class="ot">=</span><span class="fu">as.matrix</span>(<span class="fu">as.vector</span>(<span class="fu">t</span>(simdata58<span class="sc">$</span>y)))</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>x1<span class="ot">=</span><span class="fu">as.matrix</span>(<span class="fu">as.vector</span>(<span class="fu">t</span>(simdata58<span class="sc">$</span>x1)))</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="fu">Modified.GEE</span>(id, y, x1, lod, <span class="st">&quot;MIWithID&quot;</span>, <span class="st">&quot;AR-1&quot;</span>, <span class="fu">c</span>(<span class="dv">3</span>), <span class="dv">1000</span>)</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="co">#&gt; Results include typical asymptotic standard error (SE) estimates and bias-corrected SE estimates that use covariance inflation corrections.</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="co">#&gt; Covariance inflation corrections are based on the corrections of Mancl and DeRouen (MD) (2001), and Kauermann and Carroll (KC) (2001).</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="co">#&gt; Last covariance inflation correction averages the above corrections (AVG) (Ford and Westgate, 2017, 2018).</span></span></code></pre></div>
<table>
<colgroup>
<col width="17%" />
<col width="13%" />
<col width="13%" />
<col width="12%" />
<col width="15%" />
<col width="14%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Parameter</th>
<th align="left">Estimate</th>
<th align="left">Standard Error</th>
<th align="left">Wald Statistic</th>
<th align="left">p-value</th>
<th align="left">TECM</th>
<th align="left">CIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Typical Asymptotic SE</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">0</td>
<td align="left">0.451278107461759</td>
<td align="left">0.0373792382323482</td>
<td align="left">12.0729615905126</td>
<td align="left">0</td>
<td align="left">0.0025035835537326</td>
<td align="left">2.18444044418726</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left">0.251316707406584</td>
<td align="left">0.0332622323800127</td>
<td align="left">7.55561757056332</td>
<td align="left">2.22282192652301e-11</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">Bias-Corrected SE (MD)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">0</td>
<td align="left">0.451278107461759</td>
<td align="left">0.0378932991767471</td>
<td align="left">11.9091796509152</td>
<td align="left">0</td>
<td align="left">0.00259157535954833</td>
<td align="left">2.26252251135626</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">0.251316707406584</td>
<td align="left">0.0339951943228726</td>
<td align="left">7.39271277639068</td>
<td align="left">4.89126517067007e-11</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">Bias-Corrected SE (KC)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">0</td>
<td align="left">0.451278107461759</td>
<td align="left">0.0376350781892202</td>
<td align="left">11.990890657722</td>
<td align="left">0</td>
<td align="left">0.00254700065700194</td>
<td align="left">2.22296107438918</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left">0.251316707406584</td>
<td align="left">0.0336244189049152</td>
<td align="left">7.47423198947376</td>
<td align="left">3.29798410803051e-11</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">Bias-Corrected SE (AVG)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">0</td>
<td align="left">0.451278107461759</td>
<td align="left">0.0377644093877237</td>
<td align="left">11.9498256368458</td>
<td align="left">0</td>
<td align="left">0.00254700065700194</td>
<td align="left">2.24274179287272</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">0.251316707406584</td>
<td align="left">0.0338103148738894</td>
<td align="left">7.43313714598582</td>
<td align="left">4.02342603678107e-11</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">Estimated correlation</td>
<td align="left">0.140978345887248</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">Estimated dispersion</td>
<td align="left">0.366193917142601</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
</tbody>
</table>
<p>The QIF method can be performed using the function
<code>Selected.QIF()</code>, and the selected type can be then updated
in the “typed” vector of the function <code>Modified.QIF()</code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="do">## Gets initial estimates for the QIF approach through independence structure</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>initial<span class="ot">=</span><span class="fu">glm</span>(y <span class="sc">~</span> x1, <span class="at">data=</span>simdata58, <span class="at">family=</span>gaussian)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>beta_initial<span class="ot">=</span><span class="fu">as.matrix</span>(initial<span class="sc">$</span>coefficients)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="do">## Intercept is not included in the &quot;x&quot; and &quot;typed&quot;.</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="do">## Selected.QIF(id, y, x, lod, substitue, corstr, beta, maxiter)</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="fu">Selected.QIF</span>(id, y, x1, lod, <span class="st">&quot;MIWithID&quot;</span>, <span class="st">&quot;AR-1&quot;</span>, beta_initial, <span class="dv">1000</span>)</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt; Selected type of time-dependent covariate</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">#&gt; 3</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co">#&gt; Results based on the empirical MSE minimization criterion (EMMC)</span></span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Type</th>
<th align="right">EMMC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0.0027908</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">0.0024407</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">0.0010935</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outcome-data-unknown-distribution" class="section level2">
<h2>4. Outcome Data: Unknown Distribution</h2>
<p>When original or transformed data do not follow a known distribution,
modeling the conditional mean of the outcome variable may not be ideal,
as the estimated mean and standard deviation can be sensitive to large
values. In such cases, quantile regression serves as an alternative
analytical method. It does not assume an underlying distribution, offers
advantages for skewed data, and is robust to outliers. Using regression
models, substitution or fill-in approaches such as single and multiple
value imputation techniques can be employed to impute measurements below
the LOD (Chen <em>et al</em>., 2021).</p>
<div id="marginal-modeling-quantile-regression-model" class="section level3">
<h3>4-1. Marginal Modeling (Quantile Regression Model)</h3>
<p>To conduct regression analysis using the 15th simulated dataset,
where the LOD is set to 2, any measurements below 2 are imputed using
substitution approaches such as “LOD2”. The median or 50th quantile
(<span class="math inline">\(\tau = 0.5\)</span>) is used. In cluster
studies, an “exchangeable” structure is applied to the working
correlation, while an “AR-1” structure is used for longitudinal datasets
where subjects are measured over time.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>y<span class="ot">=</span><span class="fu">as.matrix</span>(<span class="fu">as.vector</span>(<span class="fu">t</span>(simdata15<span class="sc">$</span>y)))</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>x1<span class="ot">=</span><span class="fu">as.matrix</span>(<span class="fu">as.vector</span>(<span class="fu">t</span>(simdata15<span class="sc">$</span>x1)))</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>x2<span class="ot">=</span><span class="fu">as.matrix</span>(<span class="fu">as.vector</span>(<span class="fu">t</span>(simdata15<span class="sc">$</span>x2)))</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="dv">1</span>,<span class="fu">length</span>(x1),<span class="dv">1</span>),x1,x2)</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="do">## LOD = 2 is equivalent to detection proportion = 56.3% (censoring proportion = 43.7%).</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>lod<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="do">## Median or 50th quantile is given.</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>tau<span class="ot">=</span><span class="fl">0.5</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="do">## Intercept is included in the &quot;x&quot; but not in the &quot;typed&quot;.</span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="do">## Quantile.FWZ(y, x, lod, substitue, tau, corstr, typetd, data)</span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="fu">Quantile.FWZ</span>(y, x, lod, <span class="st">&quot;LOD2&quot;</span>, tau, <span class="st">&quot;exchangeable&quot;</span>, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), simdata15)</span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="co">#&gt; Quantile level and correlation structure are provided in the column of Intercept.</span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a><span class="co">#&gt;                   Intercept     X2      X3</span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="co">#&gt; Quantile Level          0.5      0       0</span></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a><span class="co">#&gt; Structure      exchangeable      0       0</span></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a><span class="co">#&gt; Estimate             0.7361 1.4998  0.7495</span></span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a><span class="co">#&gt; Standard Error       0.1007  0.353  0.7583</span></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a><span class="co">#&gt; 95% CI Lower         0.5363 0.7993 -0.7553</span></span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a><span class="co">#&gt; 95% CI Upper         0.9359 2.2003  2.2543</span></span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a><span class="co">#&gt; P-value                   0  8e-04  0.2564</span></span></code></pre></div>
</div>
<div id="time-dependent-covariates-1" class="section level3">
<h3>4-2. Time-Dependent Covariates</h3>
<p>To handle time-dependent covariates, we use the 58th simulated
dataset, which includes 100 subjects (sample size is 100), each with
three repeated measurements. The “AR-1” working correlation structure is
embedded in the function <code>Quantile.select.FWZ()</code> because
time-dependent covariates are typically associated with longitudinal
studies. A detailed description of the selection process can be found in
Chen <em>et al</em>. (2024).</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>y<span class="ot">=</span><span class="fu">as.matrix</span>(<span class="fu">as.vector</span>(<span class="fu">t</span>(simdata58<span class="sc">$</span>y)))</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>x1<span class="ot">=</span><span class="fu">as.matrix</span>(<span class="fu">as.vector</span>(<span class="fu">t</span>(simdata58<span class="sc">$</span>x1)))</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="dv">1</span>,<span class="fu">length</span>(x1),<span class="dv">1</span>),x1)</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="do">## LOD = 0.05 is equivalent to detection proportion = 50.7% (censoring proportion = 49.3%).</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>lod<span class="ot">=</span><span class="fl">0.05</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="do">## Median or 50th quantile is given.</span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>tau<span class="ot">=</span><span class="fl">0.5</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a><span class="do">## Intercept is included in the &quot;x&quot;.</span></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="do">## Quantile.select.FWZ(y, x, lod, substitue, tau, data)</span></span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a><span class="fu">Quantile.select.FWZ</span>(y, x, lod, <span class="st">&quot;LOD2&quot;</span>, tau, simdata58)</span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a><span class="co">#&gt;                                beta.0         beta.1</span></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a><span class="co">#&gt; Quantile Level           0.000000e+00   5.000000e-01</span></span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a><span class="co">#&gt; Type of Time-Dependency  0.000000e+00   1.000000e+00</span></span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a><span class="co">#&gt; Estimate                1.339392e+119 -9.268068e+118</span></span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a><span class="co">#&gt; Standard Error          1.426159e+118  9.868470e+117</span></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a><span class="co">#&gt; 95% CI Lower            1.056411e+119 -1.122619e+119</span></span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a><span class="co">#&gt; 95% CI Upper            1.622373e+119 -7.309950e+118</span></span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a><span class="co">#&gt; P-value                  1.000000e+00   1.000000e+00</span></span></code></pre></div>
<p>The selection criterion identifies <strong>type 1</strong> as the
appropriate covariate type. The quantile regression result with the
updated covariate type of time-dependency is displayed. Additionally,
this selected type of time-dependent covariate (in this case,
<strong>type 1</strong>) can also be updated in the “typed” parameter of
the function <code>Quantile.FWZ()</code>, enabling analysts to conduct
multivariable analysis.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>y<span class="ot">=</span><span class="fu">as.matrix</span>(<span class="fu">as.vector</span>(<span class="fu">t</span>(simdata58<span class="sc">$</span>y)))</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>x1<span class="ot">=</span><span class="fu">as.matrix</span>(<span class="fu">as.vector</span>(<span class="fu">t</span>(simdata58<span class="sc">$</span>x1)))</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="dv">1</span>,<span class="fu">length</span>(x1),<span class="dv">1</span>),x1)</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="do">## LOD = 0.05 is equivalent to detection proportion = 50.7% (censoring proportion = 49.3%).</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>lod<span class="ot">=</span><span class="fl">0.05</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="do">## Median or 50th quantile is given.</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>tau<span class="ot">=</span><span class="fl">0.5</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="do">## Intercept is included in the &quot;x&quot; but not in the &quot;typed&quot;.</span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="do">## Quantile.FWZ(y, x, lod, substitue, tau, corstr, typetd, data)</span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="fu">Quantile.FWZ</span>(y, x, lod, <span class="st">&quot;LOD2&quot;</span>, tau, <span class="st">&quot;AR-1&quot;</span>, <span class="fu">c</span>(<span class="dv">1</span>), simdata58)</span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a><span class="co">#&gt; Quantile level and correlation structure are provided in the column of Intercept.</span></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="co">#&gt;                            Intercept                     X2</span></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a><span class="co">#&gt; Quantile Level                   0.5                      0</span></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a><span class="co">#&gt; Structure                       AR-1                      0</span></span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a><span class="co">#&gt; Estimate       1.33939165706094e+119 -9.26806818088443e+118</span></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="co">#&gt; Standard Error 1.42615945424739e+118  9.86847009314116e+117</span></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a><span class="co">#&gt; 95% CI Lower   1.05641068058265e+119 -1.12261867453879e+119</span></span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a><span class="co">#&gt; 95% CI Upper   1.62237263353923e+119   -7.309949616381e+118</span></span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a><span class="co">#&gt; P-value                            1                      1</span></span></code></pre></div>
</div>
</div>
<div id="references" class="section level2">
<h2>5. References</h2>
<ul>
<li><p>Chen IC, Bertke SJ, Curwin BD. Quantile regression for exposure
data with repeated measures in the presence of non-detects. <em>J Expo
Sci Environ Epidemiol.</em> 2021; 31(6): 1057–1066.</p></li>
<li><p>Chen IC, Bertke SJ, Estill CF. Compare the marginal effects for
environmental exposure and biomonitoring data with repeated measurements
and values below the limit of detection. <em>J Expo Sci Environ
Epidemiol.</em> 2024. <a href="https://doi.org/10.1038/s41370-024-00640-7" class="uri">https://doi.org/10.1038/s41370-024-00640-7</a></p></li>
<li><p>Chen IC, Bertke SJ, Dahm MM. Quantile regression for longitudinal
data with values below the limit of detection and time-dependent
covariates – application to modeling carbon nanotube and nanofiber
exposures. <em>Ann Work Expo Health.</em> 2024. <a href="https://doi.org/10.1093/annweh/wxae068" class="uri">https://doi.org/10.1093/annweh/wxae068</a></p></li>
<li><p>Chen IC, Westgate PM. Improved methods for the marginal analysis
of longitudinal data in the presence of time-dependent covariates.
<em>Statistics in Medicine.</em> 2017; 36(16): 2533–2546.</p></li>
<li><p>Chen IC, Westgate PM. A novel approach to selecting
classification types for time-dependent covariates in the marginal
analysis of longitudinal data. <em>Statistical Methods in Medical
Research.</em> 2019; 28(10-11): 3176–3186.</p></li>
<li><p>Ganser GH, Hewett P. An accurate substitution method for
analyzing censored data. <em>J Occup Environ Hyg</em>. 2010; 7(4):
233–44.</p></li>
<li><p>Lai TL, Small DS. Marginal regression analysis of longitudinal
data with time-dependent covariates: a generalized method-of-moments
approach. <em>Journal of the Royal Statistical Society: Series B.</em>
2007; 69(1): 79–99.</p></li>
</ul>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
